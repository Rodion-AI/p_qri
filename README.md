# LangGraph Agent — Dual Persistence Modes

Этот проект реализует диалогового ИИ‑агента с поддержкой контекста и двумя режимами запуска:

* **Embedded / Local режим** — хранение состояния в SQLite через механизм чекпоинтов LangGraph.
* **Studio / API режим** — запуск через LangGraph Studio (`langgraph dev`) со встроенным persistence платформы.

Такое разделение необходимо из‑за ограничений LangGraph API: при запуске через Studio кастомные checkpointer’ы (например, `SqliteSaver`) не поддерживаются.

---

## Требования ТЗ — как они выполнены

### Контекст диалога

* Агент учитывает последовательность сообщений в рамках одной сессии.
* В **local‑режиме** состояние сохраняется в SQLite через `SqliteSaver`.
* В **Studio‑режиме** состояние хранится автоматически платформой LangGraph по `thread_id`.

### Интеграция с LangGraph Studio

* Агент запускается через `uv run langgraph dev`.
* Доступен для общения и отладки в LangGraph Studio UI.
---

## Переключение режимов

Режим определяется переменной окружения:

* `LANGGRAPH_STUDIO=1` → Studio / API режим
* переменная не задана → Local / SQLite режим

### Пример логики в коде

* В Studio‑режиме агент создаётся **без** `checkpointer`.
* В Local‑режиме подключается `SqliteSaver`.

---

## Запуск

### Local / SQLite

```bash
python main.py
```

* Контекст сохраняется в `agent_memory.db`
* Подходит для embedded‑использования и production‑логики

### LangGraph Studio

```bash
LANGGRAPH_STUDIO=1 uv run langgraph dev
```

* Контекст хранится платформой LangGraph
* Доступен UI для отладки и демонстрации

---

## Почему используется два режима

LangGraph Studio предназначен для:

* разработки
* отладки
* визуализации графов

SQLite persistence предназначен для:

* production / embedded сценариев
* полного контроля над хранением данных

Разделение режимов соответствует официальным ограничениям LangGraph и считается корректной архитектурной практикой.

---

## Итог

Проект:

* корректно использует LangGraph
* масштабируем для production
* прозрачно документирован
